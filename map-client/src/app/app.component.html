<div class="fullscreen">
  <mat-toolbar color="primary" class="header">
    <span>Reward search</span>
    <span class="header__spacer"></span>
    <mat-icon class="header__icon">local_airport</mat-icon>
  </mat-toolbar>
  <agm-map [latitude]="lat" [longitude]="lng" [zoom]="3" [styles]="styles">
    <agm-marker *ngFor="let ra of routeAvailabilities"
                [latitude]="ra.route.destination.location.coordinates[1]"
                [longitude]="ra.route.destination.location.coordinates[0]">
      <agm-info-window>
        {{ ra.route.destination.name }}
        {{ ra.availability }}
      </agm-info-window>
    </agm-marker>
  </agm-map>
</div>

<div class="controls mat-elevation-z4">
  <mat-accordion>
    <mat-expansion-panel [expanded]="step === 0" (opened)="setStep(0)" hideToggle="true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>date_range</mat-icon>
          {{ search.numPassengers }} from {{ search.originCode }}, {{ search.outboundDisplayValue() }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <app-filters [search]="search">
      </app-filters>

      <mat-action-row>
        <button mat-raised-button color="primary" (click)="doSearch()">Find flights</button>
      </mat-action-row>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="step === 1" (opened)="setStep(1)" hideToggle="true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>map</mat-icon>
          Select
        </mat-panel-title>
      </mat-expansion-panel-header>

      <app-destination-table [dataObservable]="routeAvailabilitiesSubj">
      </app-destination-table>
    </mat-expansion-panel>

    <mat-expansion-panel [expanded]="step === 2" (opened)="setStep(2)" hideToggle="true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon>local_airport</mat-icon>
          Finalise
        </mat-panel-title>
      </mat-expansion-panel-header>
    </mat-expansion-panel>
  </mat-accordion>
</div>
